{
  "task_id": "CR-001",
  "prompt_type": "enhanced",
  "variant_id": "v0",
  "prompt": "# Code Review Enhanced Prompt\n\n## Task\n\nAnalyze this authentication middleware for security vulnerabilities, performance issues, and code quality problems. Provide specific recommendations for each issue found, including code examples where applicable.\n\n{{#if context}}\n## Context\n\nThis middleware is used in a production Node.js application handling user authentication for a SaaS platform. It processes login requests, validates JWT tokens, and manages user sessions.\n{{/if}}\n\n{{#if code}}\n## Code\n\n```javascript\nconst jwt = require('jsonwebtoken');\nconst rateLimit = require('express-rate-limit');\n\nconst authenticate = async (req, res, next) => {\n  try {\n    // Check rate limiting\n    const limiter = rateLimit({\n      windowMs: 15 * 60 * 1000, // 15 minutes\n      max: 100, // limit each IP to 100 requests per windowMs\n      message: 'Too many requests from this IP'\n    });\n    \n    // Get token from header\n    const token = req.headers.authorization?.split(' ')[1];\n    \n    if (!token) {\n      return res.status(401).json({ error: 'No token provided' });\n    }\n    \n    // Verify JWT\n    const decoded = jwt.verify(token, process.env.JWT_SECRET);\n    req.user = decoded;\n    \n    next();\n  } catch (error) {\n    return res.status(401).json({ error: 'Invalid token' });\n  }\n};\n\nmodule.exports = authenticate;\n```\n{{/if}}\n\n# Expert Context\n\nYou are a senior security engineer with 15 years of experience at companies like Netflix, Stripe, and Cloudflare. You have deep expertise in web security, authentication systems, and secure coding practices. You have conducted hundreds of security audits and identified critical vulnerabilities in production systems.\n\n# Stakes\n\nThis security review is critical to our production system. A single missed vulnerability could lead to a data breach affecting millions of users. I'll tip you $200 for a comprehensive, perfect security analysis.\n\n# Approach\n\nTake a deep breath. I bet you can't find all the security issues in this code, but if you do, analyze step by step before providing your findings.\n\n# Task\n\nPlease review this code for security vulnerabilities, performance issues, and code quality concerns. Provide specific recommendations for each issue found, including code examples where applicable.\n\nFocus on:\n- Authentication and authorization vulnerabilities\n- Input validation and sanitization\n- SQL injection and NoSQL injection risks\n- Cross-site scripting (XSS) possibilities\n- Rate limiting and DoS protection\n- Error handling and information disclosure\n- Code structure and maintainability\n\n# Quality Check\n\nBefore finalizing, rate your confidence 0-1 in identifying all security issues and explain your reasoning. Identify any assumptions about the code's deployment context.",
  "response": "[DRY RUN] Mock response for CR-001 - enhanced variant",
  "metadata": {
    "task_id": "CR-001",
    "prompt_type": "enhanced",
    "variant_id": "v0",
    "timestamp": 1764999769.8830905,
    "provider": "mock",
    "model": "mock-model",
    "tokens_used": null,
    "cost_estimate": null,
    "response_time_ms": null,
    "cached": false
  },
  "cached": false
}